!function(e){function t(e,t){e.innerText=o(t)}function s(t,s){var i="",o="";switch(s){case"loading":i="img/loading.gif",o="加载中";break;case"error":i="img/error.png",o="播放错误";break;case"ended":i="img/ended.png",o="播放完成"}var n=e.createElement("div");n.className="video-tip",n.innerHTML='<img src ="'+i+'" /><p>'+o+"</p>",t.appendChild(n)}function i(t){var s=e.getElementsByClassName("video-tip")[0];s&&t.removeChild(s)}function o(e){var t=parseInt(e/3600),s=parseInt(parseInt(e%3600)/60),i=parseInt(parseInt(e%3600)%60);return 0==t?s>=10?i>=10?"00:"+s+":"+i:"00:"+s+":0"+i:i>=10?"00:0"+s+":"+i:"00:0"+s+":0"+i:t<10?s>=10?i>=10?"0"+t+":"+s+":"+i:"0"+t+":"+s+":0"+i:i>=10?"0"+t+":0"+s+":"+i:"0"+t+":0"+s+":0"+i:s>=10?i>=10?t+":"+s+":"+i:t+":"+s+":0"+i:i>=10?t+":0"+s+":"+i:t+":0"+s+":0"+i}var n=null,l=null,a=null,r=function(t,s){this.videoBox=e.getElementById(t),this.vid=this.videoBox.getElementsByClassName("video-tag")[0],this.oPlayBtn=this.videoBox.getElementsByClassName("play-img")[0],this.oCurrentTime=this.videoBox.getElementsByClassName("current-time")[0],this.oDuration=this.videoBox.getElementsByClassName("duration")[0],this.oRateArea=this.videoBox.getElementsByClassName("playrate-area")[0],this.oRateBtn=this.oRateArea.getElementsByClassName("playrate")[0],this.oRateList=this.oRateArea.getElementsByClassName("playrate-list")[0],this.oRateBtns=this.oRateList.getElementsByClassName("item"),this.oVolumeArea=this.videoBox.getElementsByClassName("volume-area")[0],this.oVolumeBtn=this.oVolumeArea.getElementsByClassName("volume-img")[0],this.oVolumeBar=this.oVolumeArea.getElementsByClassName("volume-bar")[0],this.oVolumeSlideBar=this.oVolumeBar.getElementsByClassName("slide-bar")[0],this.oVolumeSlider=this.oVolumeBar.getElementsByClassName("volume-slide")[0],this.oVolumeRound=this.oVolumeSlider.getElementsByClassName("round")[0],this.oFullscreenBtn=this.videoBox.getElementsByClassName("fullscreen-img")[0],this.oVidHeader=this.videoBox.getElementsByClassName("vid-hd")[0],this.oControlBar=this.videoBox.getElementsByClassName("control-bar")[0],this.oProgressBar=this.videoBox.getElementsByClassName("progress-bar")[0],this.oPlayProgress=this.oProgressBar.getElementsByClassName("play-progress")[0],this.oPreloadProgress=this.oProgressBar.getElementsByClassName("preload-progress")[0],this.oPlayRound=this.oPlayProgress.getElementsByClassName("round")[0],this.oRateBtnsLen=this.oRateBtns.length,this.src=s.src,this.autoplay=s.autoplay||!1,this.preload=!this.autoplay&&(s.preload||!1),this.volume=s.volume/100||1,this.loop=s.loop||!1,this.muted=!1,this.volumeBarShow=!1,this.isFullScreen=!1,this.init()};r.prototype={init:function(){this.setOptions(),this.bindEvent(),this.autoplay&&s(this.videoBox,"loading");var e=this;l=setTimeout(function(){e.setControlBar(!0)},5e3)},bindEvent:function(){this.vid.addEventListener("canplay",this._canplay.bind(this),!1),this.vid.addEventListener("playing",this._playing.bind(this),!1),this.vid.addEventListener("waiting",this._waiting.bind(this),!1),this.vid.addEventListener("error",this._error.bind(this),!1),this.vid.addEventListener("ended",this._ended.bind(this),!1),this.vid.addEventListener("loadstart",this._loadstart.bind(this),!1),this.oPlayBtn.addEventListener("click",this.playVideo.bind(this),!1),this.oRateBtn.addEventListener("click",this.showRateList.bind(this,!0),!1),this.oRateArea.addEventListener("mouseleave",this.showRateList.bind(this,!1),!1),this.oRateList.addEventListener("click",this.setPlayRate.bind(this),!1),this.oVolumeBtn.addEventListener("click",this.btnSetVolume.bind(this),!1),this.oVolumeArea.addEventListener("mouseleave",this.showVolumeBar.bind(this,!1),!1),this.oVolumeRound.addEventListener("mousedown",this.slideVolumeBar.bind(this),!1),this.oFullscreenBtn.addEventListener("click",this.setFullScreen.bind(this),!1),this.videoBox.addEventListener("mousemove",this.showControlBar.bind(this),!1),this.oProgressBar.addEventListener("click",this.progressClick.bind(this),!1),this.oPlayRound.addEventListener("mousedown",this.progressChange.bind(this),!1)},setOptions:function(){this.vid.src=this.src,this.vid.autoplay=this.autoplay,this.vid.preload=this.preload,this.vid.loop=this.loop,this.setVolume(this.volume,!0)},playVideo:function(){this.vid.paused?(this.oPlayBtn.src="img/pause.png",this.vid.play()):(this.oPlayBtn.src="img/play.png",this.vid.pause())},showRateList:function(e){e?this.oRateList.className+=" show":this.oRateList.className="playrate-list"},setPlayRate:function(e){var t=(e=e||window.event).target||e.srcElement;if("rate-btn"===t.className){for(var s=0;s<this.oRateBtnsLen;s++)this.oRateBtns[s].getElementsByClassName("rate-btn")[0].className="rate-btn";this.vid.playbackRate=t.getAttribute("data-rate"),t.className+=" current",this.showRateList(!1)}},btnSetVolume:function(){this.muted||this.volumeBarShow?!this.muted&&this.volumeBarShow?(this.setMuted(!0),this.setVolume(0,!0)):(this.setMuted(!1),this.setVolume(this.volume,!0)):this.showVolumeBar(!0)},showVolumeBar:function(e){e?(this.oVolumeBar.className+=" show",this.volumeBarShow=!0):(this.oVolumeBar.className="volume-bar",this.volumeBarShow=!1)},setMuted:function(e){e?(this.vid.muted=!0,this.muted=!0,this.oVolumeBtn.src="img/volume-off.png"):(this.vid.muted=!1,this.muted=!1,this.oVolumeBtn.src="img/volume.png")},setVolume:function(e,t){this.vid.volume=e,t&&(this.oVolumeSlider.style.height=100*e+"%")},setFullScreen:function(){this.isFullScreen?(e.exitFullscreen?e.exitFullscreen():e.mozExitFullscreen?e.mozExitFullscreen():e.msExitFullscreen?e.msExitFullscreen():e.oExitFullscreen?e.oExitFullscreen():e.webkitExitFullscreen&&e.webkitExitFullscreen(),this.isFullScreen=!1,this.oFullscreenBtn.src="img/fullscreen.png"):(this.videoBox.requestFullscreen?this.videoBox.requestFullscreen():this.videoBox.mozRequestFullscreen?this.videoBox.mozRequestFullscreen():this.videoBox.msRequestFullscreen?this.videoBox.msRequestFullscreen():this.videoBox.oRequestFullscreen?this.videoBox.oRequestFullscreen():this.videoBox.webkitRequestFullscreen&&this.videoBox.webkitRequestFullscreen(),this.isFullScreen=!0,this.oFullscreenBtn.src="img/fullscreen-exit.png")},setVideoState:function(e){this.oPlayBtn.src=e?"img/pause.png":"img/play.png"},setSrc:function(e){this.vid.src=e,this.vid.load()},showControlBar:function(){clearTimeout(l),l=null,this.setControlBar(!1);var e=this;l=setTimeout(function(){e.setControlBar(!0)},5e3)},setControlBar:function(e){e?(this.oVidHeader.className+=" hide",this.oControlBar.className+=" hide"):(this.oVidHeader.className="vid-hd",this.oControlBar.className="control-bar")},slideVolumeBar:function(t){function s(e){var e=e||window.event;n=e.pageY,(a=r+(l=o-n))<h&&a>0?(this.oVolumeSlider.style.height=a+"px",this.setMuted(!1)):a>=h?(this.oVolumeSlider.style.height=h+"px",a=h,this.setMuted(!1)):a<=0&&(this.oVolumeSlider.style.height="0",a=0,this.setMuted(!0)),this.volume=(a/h).toFixed(1),this.setVolume(this.volume,!1),this.volume=0==Number(this.volume)?.5:this.volume}function i(){e.removeEventListener("mousemove",d,!1),e.removeEventListener("mouseup",u,!1)}var o=(t=t||window.event).pageY,n=0,l=0,a=0,r=this.oVolumeSlider.offsetHeight,h=this.oVolumeSlideBar.offsetHeight,d=s.bind(this),u=i.bind(this);e.addEventListener("mousemove",d,!1),e.addEventListener("mouseup",u,!1)},progressClick:function(e){var e=e||window.event;this.setPlayProgress(e.pageX)},progressChange:function(){function t(e){var e=e||window.event;this.setPlayProgress(e.pageX)}function s(){e.removeEventListener("mousemove",i,!1),e.removeEventListener("mouseup",o,!1)}var i=t.bind(this),o=s.bind(this);e.addEventListener("mousemove",i,!1),e.addEventListener("mouseup",o,!1)},setPlayProgress:function(e){var s=this.vid.duration,i=e-this.videoBox.offsetLeft,o=0;o=i<=0?0:i>=this.oProgressBar.offsetWidth?1:i/this.oProgressBar.offsetWidth,this.vid.currentTime=o*s,t(this.oCurrentTime,this.vid.currentTime),this.setVideoState(!0),this.vid.play(),this.oPlayProgress.style.width=100*o+"%"},_waiting:function(){s(this.videoBox,"loading")},_loadstart:function(){i(this.videoBox),s(this.videoBox,"loading")},_canplay:function(){t(this.oDuration,this.vid.duration),i(this.videoBox);var e=this,s=this.vid.duration,o=0,n=this.oProgressBar.offsetWidth;a=setInterval(function(){o=e.vid.buffered.end(0),e.oPreloadProgress.style.width=e.vid.buffered.end(0)/s*100+"%",e.oPreloadProgress.offsetWidth>=n&&(clearInterval(a),a=null)},1e3)},_playing:function(){this.setVideoState(!0),i(this.videoBox);var e=this,s=this.vid.duration,o=0,l=this.oProgressBar.offsetWidth;n=setInterval(function(){o=e.vid.currentTime,t(e.oCurrentTime,o),e.oPlayProgress.style.width=o/s*100+"%",e.oPlayProgress.offsetWidth>=l&&(clearInterval(n),n=null)},1e3)},_error:function(){i(this.videoBox),s(this.videoBox,"error"),clearInterval(n),clearInterval(a),n=null,a=null},_ended:function(){i(this.videoBox),s(this.videoBox,"ended")}},window.MswVideo=r}(document);